<!DOCTYPE html>
<html>
    <head></head>
    <body>
        <script src="../../lib/d3.js"></script>
        <script src="../../lib/d3-selection-multi.v1.js"></script>
        <script src="../../lib/lodash.js"></script>

        <div id='title'></div>
        <svg id="svg" width="500" height="50" style="background-color: #EEEEEE"></svg>
        <div id='output'></div>

        <script type="text/javascript">
            function renderBars(caption, scale){
              var domain = scale.domain();
              var valueDelta = domain[1] - domain[0] + 1;
              var svg = d3.select('#svg');
              var svgWidth = svg.attr('width');
              var svgHeight = svg.attr('height');
              var barSpacing = 2;
              var barWidth = (svgWidth - (valueDelta-1)*barSpacing) / valueDelta;
              d3.select('#title').text(caption);
              svg.selectAll('rect')
                .data(_.range(domain[0], domain[1]+1))
                .enter()
                .append('rect')
                .attrs({
                  x: function (d, i) { return i*(barWidth+barSpacing); },
                  y: 0, 
                  width: barWidth, height: svgHeight,
                  fill: function (d) { return scale(d); }
                });
            };

            function renderBars2(caption, data, scale){
              var domain = scale.domain();
              var svg = d3.select('#svg');
              var svgWidth = svg.attr('width');
              var svgHeight = svg.attr('height');
              var barSpacing = 2;
              var barWidth = (svgWidth - (data.length-1)*barSpacing) / data.length;
              d3.select('#title').text(caption);
              svg.selectAll('rect')
                .data(data)
                .enter()
                .append('rect')
                .attrs({
                  x: function (d, i) { return i*(barWidth+barSpacing); },
                  y: 0, 
                  width: barWidth, height: svgHeight,
                  fill: function (d) { return scale(d); }
                });
            };

            function scaleBands(){
              var svg = d3.select('#svg');
              var svgWidth = svg.attr('width');
              var svgHeight = svg.attr('height');

              var data = [
                    {day : 'Mon', value: 30},
                    {day : 'Tue', value: 40},
                    {day : 'Wed', value: 30},
                    {day : 'Thu', value: 25},
                    {day : 'Fri', value: 30}
                ];
              var domainValues = d3.set(data.map(function (d) { return d.day; })).values();
              console.log(domainValues);

              var scale = d3.scaleBand()
                .domain(domainValues)
                .range([0, svgWidth])
                .paddingInner(0.05)
                .paddingOuter(0.05);

                console.log(svgWidth);
                console.log(scale.bandwidth());

                svg.selectAll('rect')
                  .data(data)
                  .enter().append('rect')
                  .attrs({
                      x: function (d) { return scale(d.day); },
                      y: function (d) { return svgHeight - d.value; }, 
                      width: scale.bandwidth(), 
                      height: function (d) { return d.value; },
                      fill: function (d, i) { return d3.schemeCategory20[i]; }
                  });
            }

            //renderBars("2 Colors", d3.scaleQuantize().domain([0, 100]).range(["brown", "steelblue"]));
            //renderBars("3 Colors", d3.scaleQuantize().domain([0, 100]).range(["brown", "orange", "steelblue"]));
            
            renderBars2("3 Colors", _.range(-0.5, 1.6, 0.1), d3.scaleThreshold().domain([0, 1]).range(["brown", "orange", "steelblue"]));
            
            //scaleBands();
		</script>
    </body>
</html>